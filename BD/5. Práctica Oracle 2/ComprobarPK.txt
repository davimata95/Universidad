SET SERVEROUTPUT ON SIZE 100000;

CREATE OR REPLACE PROCEDURE ComprobarPK IS

--DECLARE
  v_CodigoPostal "Códigos postales I"."Código postal"%TYPE;
  v_CodigoPostal2 "Códigos postales I"."Código postal"%TYPE;
  CURSOR c_CodigosPostalesI IS
    SELECT "Código postal"
      FROM "Códigos postales I";
  CURSOR c_CodigosPostalesI2 IS
    SELECT "Código postal"
      FROM "Códigos postales I";
  excepcion_repetido EXCEPTION;
  

BEGIN
  OPEN c_CodigosPostalesI;
  OPEN c_CodigosPostalesI2;
  LOOP
    FETCH c_CodigosPostalesI INTO v_CodigoPostal;
    FETCH c_CodigosPostalesI2 INTO v_CodigoPostal2;
    IF v_CodigoPostal = v_CodigoPostal2 THEN
     RAISE excepcion_repetido;
    END IF;
    EXIT WHEN c_CodigosPostalesI%NOTFOUND;
  END LOOP;
  CLOSE c_CodigosPostalesI;
  CLOSE c_CodigosPostalesI2;
--END;

EXCEPTION
  WHEN excepcion_repetido THEN
    DBMS_OUTPUT.PUT_LINE ('Violación de clave primaria en la tabla la tabla Códigos postales I.');
    DBMS_OUTPUT.PUT_LINE (v_CodigoPostal);
  
END;